graph TB
    subgraph "Multi-Format Evidence Input"
        EI[Evidence Input<br/>Any Policy Context]:::input
        EC[Evidence Content<br/>Universal Parser]:::process
        ET[Evidence Type<br/>Auto-Classification]:::process
    end

    subgraph "Dynamic Policy Context"
        PC[Policy Context<br/>Runtime Identification]:::policy
        PDR[Policy Discovery<br/>Automated Detection]:::policy
        PLC[Policy Loading<br/>Dynamic Rule Retrieval]:::policy
    end

    subgraph "Generic Hybrid Retrieval"
        GVR[Generic Vector Retrieval<br/>Multi-Domain Similarity]:::vector
        GGR[Generic Graph Retrieval<br/>Policy-Agnostic Structure]:::graph
        HRS[Hybrid Retrieval Strategy<br/>Context-Aware Combination]:::hybrid
    end

    subgraph "Multi-Domain Vector Pipeline"
        UVE[Universal Vector Embeddings<br/>Domain-Agnostic Processing]:::process
        MVS[Multi-Domain Vector Search<br/>Cross-Policy Similarity]:::process
        SPE[Similar Policy Evidence<br/>Historical Patterns]:::result
    end

    subgraph "Generic Knowledge Graph Pipeline"
        DGQ[Dynamic Graph Query<br/>Policy-Specific GQL]:::process
        PRT[Policy Rule Traversal<br/>Hierarchical Navigation]:::process
        GCR[Generic Compliance Rules<br/>Policy-Agnostic Structure]:::result
    end

    subgraph "Adaptive Context Integration"
        ACF[Adaptive Context Fusion<br/>Policy-Aware Weighting]:::integration
        DPE[Dynamic Prompt Engineering<br/>Policy-Specific Templates]:::integration
        ERP[Enhanced RAG Prompt<br/>Context + Rules + Examples]:::integration
    end

    subgraph "Generic LLM Processing"
        GLLM[Gemini 2.5 Pro<br/>Multi-Policy Reasoning]:::llm
        PRA[Policy-Specific Rule Analysis<br/>Dynamic Evaluation]:::analysis
        GCD[Generic Compliance Decision<br/>Policy-Agnostic Output]:::decision
    end

    %% Flow connections
    EI --> EC
    EC --> ET
    ET --> UVE

    PC --> PDR
    PDR --> PLC
    PLC --> DGQ

    UVE --> MVS
    MVS --> SPE

    DGQ --> PRT
    PRT --> GCR

    SPE --> ACF
    GCR --> ACF
    ACF --> DPE
    DPE --> ERP
    ERP --> GLLM

    GLLM --> PRA
    PRA --> GCD

    GVR -.-> UVE
    GGR -.-> DGQ
    HRS -.-> ACF

    %% Styling
    classDef input fill:#e6f3ff,stroke:#0066cc,stroke-width:2px
    classDef policy fill:#f0e6ff,stroke:#9900cc,stroke-width:2px
    classDef vector fill:#ffe6e6,stroke:#cc0000,stroke-width:2px
    classDef graph fill:#e6ffe6,stroke:#009900,stroke-width:2px
    classDef hybrid fill:#fff2cc,stroke:#d6b656,stroke-width:2px
    classDef process fill:#fff2e6,stroke:#ff8800,stroke-width:2px
    classDef result fill:#f0e6ff,stroke:#9900cc,stroke-width:2px
    classDef integration fill:#fffacd,stroke:#daa520,stroke-width:2px
    classDef llm fill:#e6f2ff,stroke:#0044cc,stroke-width:3px
    classDef analysis fill:#f5f5dc,stroke:#8b7d6b,stroke-width:2px
    classDef decision fill:#f0f8f0,stroke:#009900,stroke-width:2px